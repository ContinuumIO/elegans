/**
 * @license almond 0.2.9 Copyright (c) 2011-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

!function(e,t){e.Elegans=t()}(this,function(){var e,t,n;return function(i){function s(e,t){return y.call(e,t)}function r(e,t){var n,i,s,r,o,a,c,h,l,u,p,d=t&&t.split("/"),f=w.map,g=f&&f["*"]||{};if(e&&"."===e.charAt(0))if(t){for(d=d.slice(0,d.length-1),e=e.split("/"),o=e.length-1,w.nodeIdCompat&&x.test(e[o])&&(e[o]=e[o].replace(x,"")),e=d.concat(e),l=0;l<e.length;l+=1)if(p=e[l],"."===p)e.splice(l,1),l-=1;else if(".."===p){if(1===l&&(".."===e[2]||".."===e[0]))break;l>0&&(e.splice(l-1,2),l-=2)}e=e.join("/")}else 0===e.indexOf("./")&&(e=e.substring(2));if((d||g)&&f){for(n=e.split("/"),l=n.length;l>0;l-=1){if(i=n.slice(0,l).join("/"),d)for(u=d.length;u>0;u-=1)if(s=f[d.slice(0,u).join("/")],s&&(s=s[i])){r=s,a=l;break}if(r)break;!c&&g&&g[i]&&(c=g[i],h=l)}!r&&c&&(r=c,a=h),r&&(n.splice(0,a,r),e=n.join("/"))}return e}function o(e,t){return function(){return d.apply(i,R.call(arguments,0).concat([e,t]))}}function a(e){return function(t){return r(t,e)}}function c(e){return function(t){m[e]=t}}function h(e){if(s(E,e)){var t=E[e];delete E[e],v[e]=!0,p.apply(i,t)}if(!s(m,e)&&!s(v,e))throw new Error("No "+e);return m[e]}function l(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function u(e){return function(){return w&&w.config&&w.config[e]||{}}}var p,d,f,g,m={},E={},w={},v={},y=Object.prototype.hasOwnProperty,R=[].slice,x=/\.js$/;f=function(e,t){var n,i=l(e),s=i[0];return e=i[1],s&&(s=r(s,t),n=h(s)),s?e=n&&n.normalize?n.normalize(e,a(t)):r(e,t):(e=r(e,t),i=l(e),s=i[0],e=i[1],s&&(n=h(s))),{f:s?s+"!"+e:e,n:e,pr:s,p:n}},g={require:function(e){return o(e)},exports:function(e){var t=m[e];return"undefined"!=typeof t?t:m[e]={}},module:function(e){return{id:e,uri:"",exports:m[e],config:u(e)}}},p=function(e,t,n,r){var a,l,u,p,d,w,y=[],R=typeof n;if(r=r||e,"undefined"===R||"function"===R){for(t=!t.length&&n.length?["require","exports","module"]:t,d=0;d<t.length;d+=1)if(p=f(t[d],r),l=p.f,"require"===l)y[d]=g.require(e);else if("exports"===l)y[d]=g.exports(e),w=!0;else if("module"===l)a=y[d]=g.module(e);else if(s(m,l)||s(E,l)||s(v,l))y[d]=h(l);else{if(!p.p)throw new Error(e+" missing "+l);p.p.load(p.n,o(r,!0),c(l),{}),y[d]=m[l]}u=n?n.apply(m[e],y):void 0,e&&(a&&a.exports!==i&&a.exports!==m[e]?m[e]=a.exports:u===i&&w||(m[e]=u))}else e&&(m[e]=n)},e=t=d=function(e,t,n,s,r){if("string"==typeof e)return g[e]?g[e](t):h(f(e,t).f);if(!e.splice){if(w=e,w.deps&&d(w.deps,w.callback),!t)return;t.splice?(e=t,t=n,n=null):e=i}return t=t||function(){},"function"==typeof n&&(n=s,s=r),s?p(i,e,t,n):setTimeout(function(){p(i,e,t,n)},4),d},d.config=function(e){return d(e)},e._defined=m,n=function(e,t,n){t.splice||(n=t,t=[]),s(m,e)||s(E,e)||(E[e]=[e,t,n])},n.amd={jQuery:!0}}(),n("vendor/almond/almond",function(){}),n("components/world",[],function(){function e(e){this.scene=new THREE.Scene,this.camera=new THREE.OrthographicCamera(-20,20,-20,20),this.scene.add(this.camera),this.camera.position.set(-30,31,42),this.camera.rotation.set(-.6,-.5,.6);for(var t=[[1,1,1],[-1,-1,1],[-1,1,1],[1,-1,1]],n=0;4>n;n++){var i=new THREE.DirectionalLight(14540253);i.position.set(t[n][0],t[n][1],1*t[n][2]),this.scene.add(i)}return this.controls=new THREE.TrackballControls(this.camera),this.renderer=new THREE.WebGLRenderer({antialias:!0}),this.renderer.setSize(e.width,e.height),this.renderer.setClearColor(e.bg_color,1),this.camera.position.set(-30,31,42),this.camera.rotation.set(-.6,-.5,.6),this}var t;return e.prototype.begin=function(e){var n;e.each(function(){n=this}),n.appendChild(this.renderer.domElement),t=this,this.animate()},e.prototype.animate=function(){requestAnimationFrame(t.animate),t.renderer.render(t.scene,t.camera),t.controls.update()},e.prototype.addMesh=function(e){if(e instanceof Array)for(var t=0;t<e.length;t++)this.scene.add(e[t]);else this.scene.add(e)},e}),n("components/space",[],function(){function e(e){var i=-10,s=10,r=s-i,o=new THREE.PlaneGeometry(r,r),a=new THREE.MeshBasicMaterial({color:15790320,shading:THREE.FlatShading,overdraw:.5,side:THREE.DoubleSide}),c=new THREE.Mesh(o,a),h=new THREE.Mesh(o,a),l=new THREE.Mesh(o,a),u=function(e,t,n){return new THREE.Vector3(e,t,n)};h.rotateOnAxis(u(1,0,0),Math.PI/2),h.translateOnAxis(u(0,1,0),10),h.translateOnAxis(u(0,0,1),10),l.rotateOnAxis(u(0,1,0),Math.PI/2),l.translateOnAxis(u(-1,0,0),10),l.translateOnAxis(u(0,0,1),10),this.scales={},this.scales.x=d3.scale.linear().domain([e.x.max,e.x.min]).range([10,-10]),this.scales.y=d3.scale.linear().domain([e.y.max,e.y.min]).range([10,-10]),this.scales.z=d3.scale.linear().domain([e.z.max,e.z.min]).range([15,0]),this.meshes=[],this.meshes.push(c),this.meshes.push(h),this.meshes.push(l);var p=d3.scale.linear().domain([e.x.max,e.x.min]).range([20,0]),d=d3.scale.linear().domain([e.y.max,e.y.min]).range([20,0]),f=d3.scale.linear().domain([e.z.max,e.z.min]).range([15,0]);return this.meshes=this.meshes.concat(t(u(-10,10,0),u(10,10,0),u(0,1,0),p)),this.meshes=this.meshes.concat(t(u(-10,-10,0),u(-10,10,0),u(-1,0,0),d)),this.meshes=this.meshes.concat(t(u(10,10,0),u(10,10,20),u(0,1,0),f)),this.meshes.push(n([-10,10],[-10,10],[0,0],2)),this.meshes.push(n([-10,10],[-10,-10],[0,20],2)),this.meshes.push(n([10,10],[-10,10],[0,20],2)),this}var t=function(e,t,n,i){var s=[],r=new THREE.Geometry,o=(new THREE.Vector3).subVectors(t,e).normalize(),a=function(e,t){var n=new THREE.TextGeometry(e,{size:.6,font:"helvetiker",height:.1}),i=new THREE.MeshBasicMaterial({color:0});return mesh=new THREE.Mesh(n,i),mesh.position=t,mesh};r.vertices.push(e),r.vertices.push(t);var c=d3.select("body").append("svg").style("width","500").style("height","500").style("display","none"),h=c.append("g").call(d3.svg.axis().scale(i).orient("left").ticks(5)).selectAll(".tick");tick_values=[];for(var l=0;l<h[0].length;l++){attr=h[0][l].getAttribute("transform"),valueArr=/translate\(((?:-|\d|.)+),((?:-|\d|.)+)\)/g.exec(attr);var u=(new THREE.Vector3).copy(o),p=(new THREE.Vector3).copy(n),d=(new THREE.Vector3).addVectors(e,u.multiplyScalar(valueArr[2])),f=(new THREE.Vector3).addVectors(d,p.multiplyScalar(.3));p.copy(n);var g=(new THREE.Vector3).addVectors(d,p.multiplyScalar(-.3));r.vertices.push(f),r.vertices.push(g);var m=h[0][l].children[1].childNodes[0].nodeValue;p.copy(n);var E=(new THREE.Vector3).addVectors(d,p.multiplyScalar(1));label=a(m,E),s.push(label)}c.remove();var w=new THREE.LineBasicMaterial({color:0,opacity:.2}),v=new THREE.Line(r,w);return v.type=THREE.LinePieces,s.push(v),s},n=function(e,t,n,i){var s=new THREE.Geometry;if(e[0]!=e[1])for(var r=e[0];r<=e[1];r+=i)s.vertices.push(new THREE.Vector3(r,t[0],n[0])),s.vertices.push(new THREE.Vector3(r,t[1],n[1]));if(t[0]!=t[1])for(var o=t[0];o<=t[1];o+=i)s.vertices.push(new THREE.Vector3(e[0],o,n[0])),s.vertices.push(new THREE.Vector3(e[1],o,n[1]));if(n[0]!=n[1])for(var a=n[0];a<=n[1];a+=i)s.vertices.push(new THREE.Vector3(e[0],t[0],a)),s.vertices.push(new THREE.Vector3(e[1],t[1],a));var c=new THREE.LineBasicMaterial({color:13421772,opacity:.2}),h=new THREE.Line(s,c);return h.type=THREE.LinePieces,h};return e.prototype.getScales=function(){return this.scales},e.prototype.getMeshes=function(){return this.meshes},e}),n("utils/utils",[],function(){var e=function(e,t){t.call(e)},t=function(e,t){for(var n in t)e[n]=t[n]};return exports={mixin:e,merge:t}}),n("components/stage",["components/world","components/space","utils/utils"],function(e,t,n){function i(e,t){this.options={width:700,height:500,world_width:500,bg_color:16777215},arguments.length>1&&n.merge(this.options,t);var i=d3.select(e);return i.style("width",String(this.options.width)),this.world_space=i.append("div").style("float","left").style("width",String(this.options.world_width)).style("height",String(this.options.height)),this.legend_space=i.append("svg").style("float","left").style("width",String(this.options.width-this.options.world_width)).style("height",String(this.options.height)),this.charts=[],this}return i.prototype.render=function(){this.world.begin(this.world_space)},i.prototype.add=function(n){0==this.charts.length&&(this.world=new e({width:this.options.world_width,height:this.options.height,bg_color:this.options.bg_color}),this.space=new t(n.getDataRanges()),this.world.addMesh(this.space.getMeshes())),n.generateMesh(this.space.getScales()),this.world.addMesh(n.getMesh()),n.hasLegend()&&n.addLegend(this.legend_space),this.charts.push(n)},i}),n("components/legends",[],function(){function e(e,t,n){for(var i=d3.scale.linear().domain([t.max,t.min]).range([0,200]),s=e.append("svg:defs").append("svg:linearGradient").attr("id","gradient").attr("x1","0%").attr("x2","0%").attr("y1","100%").attr("y2","0%"),r=0;r<n.length;r++)s.append("svg:stop").attr("offset",100/(n.length-1)*r+"%").attr("stop-color",n[r]);var o=e.append("g");o.append("svg:rect").attr("y",10).attr("width","25").attr("height","200").style("fill","url(#gradient)"),e.append("g").attr("width","100").attr("height","200").attr("class","axis").attr("transform","translate(25,10)").call(d3.svg.axis().scale(i).orient("right").ticks(5))}var t={addContinuousLegend:e};return t}),n("utils/range",[],function(){function e(e,t){this.max=e,this.min=t}return e.prototype.divide=function(e){for(var t=new Array,n=Math.ceil((this.max-this.min)/(e-1)),i=0;e>i;i++)t.push(this.min+n*i);return t},e}),n("utils/datasets",["utils/range"],function(e){function t(t){for(var n=new Array,i=[function(e){return e.x},function(e){return e.y},function(e){return e.z}],s=0;3>s;s++)n[s]=new e(d3.max(t,function(e){return d3.max(e,i[s])}),d3.min(t,function(e){return d3.min(e,i[s])}));return this.ranges={x:n[0],y:n[1],z:n[2]},this.data=t,this}return t.prototype.getRanges=function(){return this.ranges},Datasets={Matrix:t}}),n("charts/surface",["components/legends","utils/utils","utils/datasets"],function(e,t,n){function i(e,i){this.options={fill_colors:colorbrewer.Reds[3],has_legend:!0},arguments.length>1&&t.merge(this.options,i),this.dataset=new n.Matrix(e),this.ranges=this.dataset.getRanges(),this.color_scale=d3.scale.linear().domain(this.ranges.z.divide(this.options.fill_colors.length)).range(this.options.fill_colors)}return i.prototype.generateMesh=function(e){var t=this.dataset.data,n=new THREE.Geometry,i=t.length,s=t[0].length,r=this.color_scale,o=[],a=function(e,t){return e*i+t},c=function(e,t,n,i,s){var r=new THREE.Vector3,o=new THREE.Vector3;r.subVectors(e.vertices[t],e.vertices[n]),o.subVectors(e.vertices[t],e.vertices[i]),o.cross(r).normalize();var a=[s[t],s[n],s[i]];e.faces.push(new THREE.Face3(t,n,i,o,a)),a=[s[i],s[n],s[t]],e.faces.push(new THREE.Face3(i,n,t,o.negate(),a))};t.forEach(function(t){t.forEach(function(t){n.vertices.push(new THREE.Vector3(e.x(t.x),e.y(t.y),e.z(t.z))),o.push(new THREE.Color(r(t.z)))})});for(var h=0;i-1>h;h++)for(var l=0;s-1>l;l++)c(n,a(h,l),a(h+1,l),a(h,l+1),o),c(n,a(h+1,l),a(h+1,l+1),a(h,l+1),o);var u=new THREE.MeshBasicMaterial({vertexColors:THREE.VertexColors});this.mesh=new THREE.Mesh(n,u)},i.prototype.getDataRanges=function(){return this.ranges},i.prototype.hasLegend=function(){return this.options.has_legend},i.prototype.addLegend=function(t){e.addContinuousLegend(t,this.ranges.z,this.options.fill_colors)},i.prototype.getMesh=function(){return this.mesh},i}),n("quick/base",[],function(){return Base=function(){this.options={},this.width=function(e){return arguments.length?void(this.options.width=e):this.options.width},this.height=function(e){return arguments.length?void(this.options.height=e):this.options.height},this.bg_color=function(e){return arguments.length?void(this.options.bg_color=e):this.options.bg_color},this.legend=function(e){return arguments.length?void(this.options.legend=e):this.options.legend}}}),n("quick/surface_plot",["components/stage","quick/base","charts/surface","utils/utils"],function(e,t,n,i){function s(t){t.each(function(t){var i=new e(this);i.add(new n(t,options)),i.render()})}return i.mixin(s,t),s.fill_colors=function(e){return arguments.length?(this.options.fill_colors=e,options=this.options,this):this.options.bg_color},s}),n("main",["require","exports","module","components/stage","charts/surface","quick/surface_plot"],function(e){return Elegans={},Elegans.Stage=e("components/stage"),Elegans.Surface=e("charts/surface"),Elegans.SurfacePlot=e("quick/surface_plot"),Elegans}),t("main")});