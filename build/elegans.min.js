/**
 * @license almond 0.2.9 Copyright (c) 2011-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

!function(e,t){e.Elegans=t()}(this,function(){var e,t,n;return function(r){function i(e,t){return R.call(e,t)}function s(e,t){var n,r,i,s,o,a,c,u,l,h,f,p=t&&t.split("/"),d=v.map,g=d&&d["*"]||{};if(e&&"."===e.charAt(0))if(t){for(p=p.slice(0,p.length-1),e=e.split("/"),o=e.length-1,v.nodeIdCompat&&H.test(e[o])&&(e[o]=e[o].replace(H,"")),e=p.concat(e),l=0;l<e.length;l+=1)if(f=e[l],"."===f)e.splice(l,1),l-=1;else if(".."===f){if(1===l&&(".."===e[2]||".."===e[0]))break;l>0&&(e.splice(l-1,2),l-=2)}e=e.join("/")}else 0===e.indexOf("./")&&(e=e.substring(2));if((p||g)&&d){for(n=e.split("/"),l=n.length;l>0;l-=1){if(r=n.slice(0,l).join("/"),p)for(h=p.length;h>0;h-=1)if(i=d[p.slice(0,h).join("/")],i&&(i=i[r])){s=i,a=l;break}if(s)break;!c&&g&&g[r]&&(c=g[r],u=l)}!s&&c&&(s=c,a=u),s&&(n.splice(0,a,s),e=n.join("/"))}return e}function o(e,t){return function(){return p.apply(r,T.call(arguments,0).concat([e,t]))}}function a(e){return function(t){return s(t,e)}}function c(e){return function(t){E[e]=t}}function u(e){if(i(m,e)){var t=m[e];delete m[e],w[e]=!0,f.apply(r,t)}if(!i(E,e)&&!i(w,e))throw new Error("No "+e);return E[e]}function l(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function h(e){return function(){return v&&v.config&&v.config[e]||{}}}var f,p,d,g,E={},m={},v={},w={},R=Object.prototype.hasOwnProperty,T=[].slice,H=/\.js$/;d=function(e,t){var n,r=l(e),i=r[0];return e=r[1],i&&(i=s(i,t),n=u(i)),i?e=n&&n.normalize?n.normalize(e,a(t)):s(e,t):(e=s(e,t),r=l(e),i=r[0],e=r[1],i&&(n=u(i))),{f:i?i+"!"+e:e,n:e,pr:i,p:n}},g={require:function(e){return o(e)},exports:function(e){var t=E[e];return"undefined"!=typeof t?t:E[e]={}},module:function(e){return{id:e,uri:"",exports:E[e],config:h(e)}}},f=function(e,t,n,s){var a,l,h,f,p,v,R=[],T=typeof n;if(s=s||e,"undefined"===T||"function"===T){for(t=!t.length&&n.length?["require","exports","module"]:t,p=0;p<t.length;p+=1)if(f=d(t[p],s),l=f.f,"require"===l)R[p]=g.require(e);else if("exports"===l)R[p]=g.exports(e),v=!0;else if("module"===l)a=R[p]=g.module(e);else if(i(E,l)||i(m,l)||i(w,l))R[p]=u(l);else{if(!f.p)throw new Error(e+" missing "+l);f.p.load(f.n,o(s,!0),c(l),{}),R[p]=E[l]}h=n?n.apply(E[e],R):void 0,e&&(a&&a.exports!==r&&a.exports!==E[e]?E[e]=a.exports:h===r&&v||(E[e]=h))}else e&&(E[e]=n)},e=t=p=function(e,t,n,i,s){if("string"==typeof e)return g[e]?g[e](t):u(d(e,t).f);if(!e.splice){if(v=e,v.deps&&p(v.deps,v.callback),!t)return;t.splice?(e=t,t=n,n=null):e=r}return t=t||function(){},"function"==typeof n&&(n=i,i=s),i?f(r,e,t,n):setTimeout(function(){f(r,e,t,n)},4),p},p.config=function(e){return p(e)},e._defined=E,n=function(e,t,n){t.splice||(n=t,t=[]),i(E,e)||i(m,e)||(m[e]=[e,t,n])},n.amd={jQuery:!0}}(),n("vendor/almond/almond",function(){}),n("charts/base",[],function(){return Base=function(){this.options={width:500,height:500,bg_color:16777215,legend:!0},this.width=function(e){return arguments.length?void(this.options.width=e):this.options.width},this.height=function(e){return arguments.length?void(this.options.height=e):this.options.height},this.bg_color=function(e){return arguments.length?void(this.options.bg_color=e):this.options.bg_color},this.legend=function(e){return arguments.length?void(this.options.legend=e):this.options.legend}}}),n("components/world",[],function(){function e(e,t){this.scene=new THREE.Scene,this.camera=new THREE.OrthographicCamera(-20,20,-20,20),this.scene.add(this.camera),this.camera.position.set(135,135,50),this.camera.lookAt(this.scene.position);for(var n=[[1,1,1],[-1,-1,1],[-1,1,1],[1,-1,1]],r=0;4>r;r++){var i=new THREE.DirectionalLight(14540253);i.position.set(n[r][0],n[r][1],1*n[r][2]),this.scene.add(i)}return this.controls=new THREE.TrackballControls(this.camera),this.renderer=new THREE.WebGLRenderer({antialias:!0}),this.renderer.setSize(t.width,t.height),this.renderer.setClearColor(t.bg_color,1),e.appendChild(this.renderer.domElement),this}var t;return e.prototype.begin=function(){t=this,this.animate()},e.prototype.animate=function(){requestAnimationFrame(t.animate),t.renderer.render(t.scene,t.camera),t.controls.update()},e.prototype.addMesh=function(e){if(e instanceof Array)for(var t=0;t<e.length;t++)this.scene.add(e[t]);else this.scene.add(e)},e}),n("components/space",[],function(){function e(e){var n=-10,r=10,i=r-n,s=new THREE.PlaneGeometry(i,i),o=new THREE.MeshBasicMaterial({color:15790320,shading:THREE.FlatShading,overdraw:.5,side:THREE.DoubleSide}),a=new THREE.Mesh(s,o),c=new THREE.Mesh(s,o),u=new THREE.Mesh(s,o);return c.rotateOnAxis(new THREE.Vector3(1,0,0),Math.PI/2),c.translateOnAxis(new THREE.Vector3(0,1,0),10),c.translateOnAxis(new THREE.Vector3(0,0,1),10),u.rotateOnAxis(new THREE.Vector3(0,1,0),Math.PI/2),u.translateOnAxis(new THREE.Vector3(-1,0,0),10),u.translateOnAxis(new THREE.Vector3(0,0,1),10),this.meshes=[],this.meshes.push(a),this.meshes.push(c),this.meshes.push(u),this.meshes.push(t([-10,10],[-10,10],[0,0],2)),this.meshes.push(t([-10,10],[-10,-10],[0,20],2)),this.meshes.push(t([10,10],[-10,10],[0,20],2)),this.scales={},this.scales.x=d3.scale.linear().domain([e[0][0],e[0][1]]).range([10,-10]),this.scales.y=d3.scale.linear().domain([e[1][0],e[1][1]]).range([10,-10]),this.scales.z=d3.scale.linear().domain([e[2][0],e[2][1]]).range([15,0]),this}function t(e,t,n,r){var i=new THREE.Geometry;if(e[0]!=e[1])for(var s=e[0];s<=e[1];s+=r)i.vertices.push(new THREE.Vector3(s,t[0],n[0])),i.vertices.push(new THREE.Vector3(s,t[1],n[1]));if(t[0]!=t[1])for(var o=t[0];o<=t[1];o+=r)i.vertices.push(new THREE.Vector3(e[0],o,n[0])),i.vertices.push(new THREE.Vector3(e[1],o,n[1]));if(n[0]!=n[1])for(var a=n[0];a<=n[1];a+=r)i.vertices.push(new THREE.Vector3(e[0],t[0],a)),i.vertices.push(new THREE.Vector3(e[1],t[1],a));var c=new THREE.LineBasicMaterial({color:13421772,opacity:.2}),u=new THREE.Line(i,c);return u.type=THREE.LinePieces,u}return e.prototype.getScales=function(){return this.scales},e.prototype.getMesh=function(){return this.meshes},e}),n("components/legend",[],function(){function e(){return this}return e.prototype.addContinuousColormap=function(e,t){for(var n=d3.select("svg"),r=d3.scale.linear().domain([e[0],e[1]]).range([0,200]),i=n.append("svg:defs").append("svg:linearGradient").attr("id","gradient").attr("x1","0%").attr("x2","0%").attr("y1","100%").attr("y2","0%"),s=0;s<t.length;s++)i.append("svg:stop").attr("offset",100/t.length*s+"%").attr("stop-color",t[s]);var o=n.append("g");o.append("svg:rect").attr("y",10).attr("width","50").attr("height","200").style("fill","url(#gradient)"),n.append("g").attr("width","100").attr("height","200").attr("class","axis").attr("transform","translate(50,10)").call(d3.svg.axis(r).scale(r).orient("right").ticks(5))},e}),n("utils/utils",[],function(){var e=function(e,t){t.call(e)},t=function(e,t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])};return exports={mixin:e,merge:t}}),n("charts/surface",["charts/base","components/world","components/space","components/legend","utils/utils"],function(e,t,n,r,i){function s(s){i.mixin(this,e);var a={fill_colors:colorbrewer.Reds[3]};this.constructor(),i.merge(this.options,a);var c,u={width:this.options.width,height:this.options.height,bg_color:this.options.bg_color};s.each(function(){c=new t(this,u)}),ranges=[];for(var l=[function(e){return e.x},function(e){return e.y},function(e){return e.z}],h=0;3>h;h++)ranges[h]=[d3.max(data,function(e){return d3.max(e,l[h])}),d3.min(data,function(e){return d3.min(e,l[h])})];var f=new n(ranges);c.addMesh(f.getMesh());var p=(ranges[2][0]+ranges[2][1])/2,d=d3.scale.linear().domain([ranges[2][1],p,ranges[2][0]]).range(this.options.fill_colors),g=o(data,f.getScales(),d);if(c.addMesh(g),1==this.options.legend){var E=new r;E.addContinuousColormap(ranges[2],this.options.fill_colors)}c.begin()}function o(e,t,n){var r=new THREE.Geometry,i=e.length,s=e[0].length,o=[],a=function(e,t){return e*i+t},c=function(e,t,n,r,i){var s=new THREE.Vector3,o=new THREE.Vector3;s.subVectors(e.vertices[t],e.vertices[n]),o.subVectors(e.vertices[t],e.vertices[r]),o.cross(s).normalize();var a=[i[t],i[n],i[r]];e.faces.push(new THREE.Face3(t,n,r,o,a)),a=[i[r],i[n],i[t]],e.faces.push(new THREE.Face3(r,n,t,o.negate(),a))};e.forEach(function(e){e.forEach(function(e){r.vertices.push(new THREE.Vector3(t.x(e.x),t.y(e.y),t.z(e.z))),o.push(new THREE.Color(n(e.z)))})});for(var u=0;i-1>u;u++)for(var l=0;s-1>l;l++)c(r,a(u,l),a(u+1,l),a(u,l+1),o),c(r,a(u+1,l),a(u+1,l+1),a(u,l+1),o);var h=new THREE.MeshBasicMaterial({vertexColors:THREE.VertexColors}),f=new THREE.Mesh(r,h);return f}return s.fill_colors=function(e){return arguments.length?void(this.options.fill_colors=e):this.options.bg_color},s}),n("main",["require","exports","module","charts/surface"],function(e){return Elegans={},Elegans.Surface=e("charts/surface"),Elegans}),t("main")});