/**
 * @license almond 0.2.9 Copyright (c) 2011-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

!function(e,t){e.Elegans=t()}(this,function(){var e,t,n;return function(r){function s(e,t){return y.call(e,t)}function i(e,t){var n,r,s,i,o,a,c,h,l,u,p,d=t&&t.split("/"),f=w.map,g=f&&f["*"]||{};if(e&&"."===e.charAt(0))if(t){for(d=d.slice(0,d.length-1),e=e.split("/"),o=e.length-1,w.nodeIdCompat&&T.test(e[o])&&(e[o]=e[o].replace(T,"")),e=d.concat(e),l=0;l<e.length;l+=1)if(p=e[l],"."===p)e.splice(l,1),l-=1;else if(".."===p){if(1===l&&(".."===e[2]||".."===e[0]))break;l>0&&(e.splice(l-1,2),l-=2)}e=e.join("/")}else 0===e.indexOf("./")&&(e=e.substring(2));if((d||g)&&f){for(n=e.split("/"),l=n.length;l>0;l-=1){if(r=n.slice(0,l).join("/"),d)for(u=d.length;u>0;u-=1)if(s=f[d.slice(0,u).join("/")],s&&(s=s[r])){i=s,a=l;break}if(i)break;!c&&g&&g[r]&&(c=g[r],h=l)}!i&&c&&(i=c,a=h),i&&(n.splice(0,a,i),e=n.join("/"))}return e}function o(e,t){return function(){return d.apply(r,R.call(arguments,0).concat([e,t]))}}function a(e){return function(t){return i(t,e)}}function c(e){return function(t){E[e]=t}}function h(e){if(s(m,e)){var t=m[e];delete m[e],v[e]=!0,p.apply(r,t)}if(!s(E,e)&&!s(v,e))throw new Error("No "+e);return E[e]}function l(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function u(e){return function(){return w&&w.config&&w.config[e]||{}}}var p,d,f,g,E={},m={},w={},v={},y=Object.prototype.hasOwnProperty,R=[].slice,T=/\.js$/;f=function(e,t){var n,r=l(e),s=r[0];return e=r[1],s&&(s=i(s,t),n=h(s)),s?e=n&&n.normalize?n.normalize(e,a(t)):i(e,t):(e=i(e,t),r=l(e),s=r[0],e=r[1],s&&(n=h(s))),{f:s?s+"!"+e:e,n:e,pr:s,p:n}},g={require:function(e){return o(e)},exports:function(e){var t=E[e];return"undefined"!=typeof t?t:E[e]={}},module:function(e){return{id:e,uri:"",exports:E[e],config:u(e)}}},p=function(e,t,n,i){var a,l,u,p,d,w,y=[],R=typeof n;if(i=i||e,"undefined"===R||"function"===R){for(t=!t.length&&n.length?["require","exports","module"]:t,d=0;d<t.length;d+=1)if(p=f(t[d],i),l=p.f,"require"===l)y[d]=g.require(e);else if("exports"===l)y[d]=g.exports(e),w=!0;else if("module"===l)a=y[d]=g.module(e);else if(s(E,l)||s(m,l)||s(v,l))y[d]=h(l);else{if(!p.p)throw new Error(e+" missing "+l);p.p.load(p.n,o(i,!0),c(l),{}),y[d]=E[l]}u=n?n.apply(E[e],y):void 0,e&&(a&&a.exports!==r&&a.exports!==E[e]?E[e]=a.exports:u===r&&w||(E[e]=u))}else e&&(E[e]=n)},e=t=d=function(e,t,n,s,i){if("string"==typeof e)return g[e]?g[e](t):h(f(e,t).f);if(!e.splice){if(w=e,w.deps&&d(w.deps,w.callback),!t)return;t.splice?(e=t,t=n,n=null):e=r}return t=t||function(){},"function"==typeof n&&(n=s,s=i),s?p(r,e,t,n):setTimeout(function(){p(r,e,t,n)},4),d},d.config=function(e){return d(e)},e._defined=E,n=function(e,t,n){t.splice||(n=t,t=[]),s(E,e)||s(m,e)||(m[e]=[e,t,n])},n.amd={jQuery:!0}}(),n("vendor/almond/almond",function(){}),n("components/world",[],function(){function e(e){this.scene=new THREE.Scene,this.camera=new THREE.OrthographicCamera(-20,20,-20,20),this.scene.add(this.camera),this.camera.position.set(-30,31,42),this.camera.rotation.set(-.6,-.5,.6);for(var t=[[1,1,1],[-1,-1,1],[-1,1,1],[1,-1,1]],n=0;4>n;n++){var r=new THREE.DirectionalLight(14540253);r.position.set(t[n][0],t[n][1],1*t[n][2]),this.scene.add(r)}return this.controls=new THREE.TrackballControls(this.camera),this.renderer=new THREE.WebGLRenderer({antialias:!0}),this.renderer.setSize(e.width,e.height),this.renderer.setClearColor(e.bg_color,1),this.camera.position.set(-30,31,42),this.camera.rotation.set(-.6,-.5,.6),this}var t;return e.prototype.begin=function(e){var n;e.each(function(){n=this}),n.appendChild(this.renderer.domElement),t=this,this.animate()},e.prototype.animate=function(){requestAnimationFrame(t.animate),t.renderer.render(t.scene,t.camera),t.controls.update()},e.prototype.addMesh=function(e){if(e instanceof Array)for(var t=0;t<e.length;t++)this.scene.add(e[t]);else this.scene.add(e)},e}),n("components/space",[],function(){function e(e){var r=-10,s=10,i=s-r,o=new THREE.PlaneGeometry(i,i),a=new THREE.MeshBasicMaterial({color:15790320,shading:THREE.FlatShading,overdraw:.5,side:THREE.DoubleSide}),c=new THREE.Mesh(o,a),h=new THREE.Mesh(o,a),l=new THREE.Mesh(o,a),u=function(e,t,n){return new THREE.Vector3(e,t,n)};h.rotateOnAxis(u(1,0,0),Math.PI/2),h.translateOnAxis(u(0,1,0),10),h.translateOnAxis(u(0,0,1),10),l.rotateOnAxis(u(0,1,0),Math.PI/2),l.translateOnAxis(u(-1,0,0),10),l.translateOnAxis(u(0,0,1),10),this.scales={},this.scales.x=d3.scale.linear().domain([e[0][0],e[0][1]]).range([10,-10]),this.scales.y=d3.scale.linear().domain([e[1][0],e[1][1]]).range([10,-10]),this.scales.z=d3.scale.linear().domain([e[2][0],e[2][1]]).range([15,0]),this.meshes=[],this.meshes.push(c),this.meshes.push(h),this.meshes.push(l);var p=d3.scale.linear().domain([e[0][0],e[0][1]]).range([20,0]),d=d3.scale.linear().domain([e[1][0],e[1][1]]).range([20,0]),f=d3.scale.linear().domain([e[2][0],e[2][1]]).range([15,0]);return this.meshes=this.meshes.concat(t(u(-10,10,0),u(10,10,0),u(0,1,0),p)),this.meshes=this.meshes.concat(t(u(-10,-10,0),u(-10,10,0),u(-1,0,0),d)),this.meshes=this.meshes.concat(t(u(10,10,0),u(10,10,20),u(0,1,0),f)),this.meshes.push(n([-10,10],[-10,10],[0,0],2)),this.meshes.push(n([-10,10],[-10,-10],[0,20],2)),this.meshes.push(n([10,10],[-10,10],[0,20],2)),this}var t=function(e,t,n,r){var s=[],i=new THREE.Geometry,o=(new THREE.Vector3).subVectors(t,e).normalize(),a=function(e,t){var n=new THREE.TextGeometry(e,{size:.6,font:"helvetiker",height:.1}),r=new THREE.MeshBasicMaterial({color:0});return mesh=new THREE.Mesh(n,r),mesh.position=t,mesh};i.vertices.push(e),i.vertices.push(t);var c=d3.select("body").append("svg").style("width","500").style("height","500").style("display","none"),h=c.append("g").call(d3.svg.axis().scale(r).orient("left").ticks(5)).selectAll(".tick");tick_values=[];for(var l=0;l<h[0].length;l++){attr=h[0][l].getAttribute("transform"),valueArr=/translate\(((?:-|\d|.)+),((?:-|\d|.)+)\)/g.exec(attr);var u=(new THREE.Vector3).copy(o),p=(new THREE.Vector3).copy(n),d=(new THREE.Vector3).addVectors(e,u.multiplyScalar(valueArr[2])),f=(new THREE.Vector3).addVectors(d,p.multiplyScalar(.3));p.copy(n);var g=(new THREE.Vector3).addVectors(d,p.multiplyScalar(-.3));i.vertices.push(f),i.vertices.push(g);var E=h[0][l].children[1].childNodes[0].nodeValue;p.copy(n);var m=(new THREE.Vector3).addVectors(d,p.multiplyScalar(1));label=a(E,m),s.push(label)}var w=new THREE.LineBasicMaterial({color:0,opacity:.2}),v=new THREE.Line(i,w);return v.type=THREE.LinePieces,s.push(v),s},n=function(e,t,n,r){var s=new THREE.Geometry;if(e[0]!=e[1])for(var i=e[0];i<=e[1];i+=r)s.vertices.push(new THREE.Vector3(i,t[0],n[0])),s.vertices.push(new THREE.Vector3(i,t[1],n[1]));if(t[0]!=t[1])for(var o=t[0];o<=t[1];o+=r)s.vertices.push(new THREE.Vector3(e[0],o,n[0])),s.vertices.push(new THREE.Vector3(e[1],o,n[1]));if(n[0]!=n[1])for(var a=n[0];a<=n[1];a+=r)s.vertices.push(new THREE.Vector3(e[0],t[0],a)),s.vertices.push(new THREE.Vector3(e[1],t[1],a));var c=new THREE.LineBasicMaterial({color:13421772,opacity:.2}),h=new THREE.Line(s,c);return h.type=THREE.LinePieces,h};return e.prototype.getScales=function(){return this.scales},e.prototype.getMeshes=function(){return this.meshes},e}),n("utils/utils",[],function(){var e=function(e,t){t.call(e)},t=function(e,t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])};return exports={mixin:e,merge:t}}),n("components/stage",["components/world","components/space","utils/utils"],function(e,t,n){function r(e,t){return this.options={width:700,height:500,world_width:500,bg_color:16777215},arguments.length>1&&n.merge(this.options,t),e.style("width",String(this.options.width)),this.world_space=e.append("div").style("float","left").style("width",String(this.options.world_width)),this.legend_space=e.append("svg").style("float","left").style("width",String(this.options.width-this.options.world_width)),this.charts=[],this}return r.prototype.render=function(){this.world.begin(this.world_space)},r.prototype.add=function(n){0==this.charts.length&&(this.world=new e({width:this.options.world_width,height:this.options.height,bg_color:this.options.bg_color}),this.space=new t(n.getDataRanges()),this.world.addMesh(this.space.getMeshes())),n.generateMesh(this.space.getScales()),this.world.addMesh(n.getMesh()),n.hasLegend()&&n.addLegend(this.legend_space),this.charts.push(n)},r}),n("components/legends",[],function(){function e(e,t,n){for(var r=d3.scale.linear().domain([t[0],t[1]]).range([0,200]),s=e.append("svg:defs").append("svg:linearGradient").attr("id","gradient").attr("x1","0%").attr("x2","0%").attr("y1","100%").attr("y2","0%"),i=0;i<n.length;i++)s.append("svg:stop").attr("offset",100/n.length*i+"%").attr("stop-color",n[i]);var o=e.append("g");o.append("svg:rect").attr("y",10).attr("width","25").attr("height","200").style("fill","url(#gradient)"),e.append("g").attr("width","100").attr("height","200").attr("class","axis").attr("transform","translate(25,10)").call(d3.svg.axis().scale(r).orient("right").ticks(5))}var t={addContinuousLegend:e};return t}),n("charts/surface",["components/legends","utils/utils"],function(e,t){function n(e,n){this.options={fill_colors:colorbrewer.Reds[3],has_legend:!0},arguments.length>1&&t.merge(this.options,n),ranges=[];for(var r=[function(e){return e.x},function(e){return e.y},function(e){return e.z}],s=0;3>s;s++)ranges[s]=[d3.max(e,function(e){return d3.max(e,r[s])}),d3.min(e,function(e){return d3.min(e,r[s])})];var i=(ranges[2][0]+ranges[2][1])/2;this.color_scale=d3.scale.linear().domain([ranges[2][1],i,ranges[2][0]]).range(this.options.fill_colors),this.ranges=ranges,this.data=e}return n.prototype.getDataRanges=function(){return this.ranges},n.prototype.hasLegend=function(){return this.options.has_legend},n.prototype.addLegend=function(t){e.addContinuousLegend(t,this.ranges[2],this.options.fill_colors)},n.prototype.getMesh=function(){return this.mesh},n.prototype.generateMesh=function(e){var t=this.data,n=new THREE.Geometry,r=t.length,s=t[0].length,i=this.color_scale,o=[],a=function(e,t){return e*r+t},c=function(e,t,n,r,s){var i=new THREE.Vector3,o=new THREE.Vector3;i.subVectors(e.vertices[t],e.vertices[n]),o.subVectors(e.vertices[t],e.vertices[r]),o.cross(i).normalize();var a=[s[t],s[n],s[r]];e.faces.push(new THREE.Face3(t,n,r,o,a)),a=[s[r],s[n],s[t]],e.faces.push(new THREE.Face3(r,n,t,o.negate(),a))};t.forEach(function(t){t.forEach(function(t){n.vertices.push(new THREE.Vector3(e.x(t.x),e.y(t.y),e.z(t.z))),o.push(new THREE.Color(i(t.z)))})});for(var h=0;r-1>h;h++)for(var l=0;s-1>l;l++)c(n,a(h,l),a(h+1,l),a(h,l+1),o),c(n,a(h+1,l),a(h+1,l+1),a(h,l+1),o);var u=new THREE.MeshBasicMaterial({vertexColors:THREE.VertexColors});this.mesh=new THREE.Mesh(n,u)},n}),n("quick/base",[],function(){return Base=function(){this.options={},this.width=function(e){return arguments.length?void(this.options.width=e):this.options.width},this.height=function(e){return arguments.length?void(this.options.height=e):this.options.height},this.bg_color=function(e){return arguments.length?void(this.options.bg_color=e):this.options.bg_color},this.legend=function(e){return arguments.length?void(this.options.legend=e):this.options.legend}}}),n("quick/surface_plot",["components/stage","quick/base","charts/surface","utils/utils"],function(e,t,n,r){function s(t){var r=this.options;t.each(function(s){var i=new e(t);i.add(new n(s,r)),i.render()})}return n.fill_colors=function(e){return arguments.length?void(this.options.fill_colors=e):this.options.bg_color},r.mixin(s,t),s}),n("main",["require","exports","module","components/stage","charts/surface","quick/surface_plot"],function(e){return Elegans={},Elegans.Stage=e("components/stage"),Elegans.Surface=e("charts/surface"),Elegans.SurfacePlot=e("quick/surface_plot"),Elegans}),t("main")});