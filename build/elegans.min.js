/**
 * @license almond 0.2.9 Copyright (c) 2011-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

!function(e,t){e.Elegans=t()}(this,function(){var e,t,n;return function(r){function i(e,t){return R.call(e,t)}function s(e,t){var n,r,i,s,o,a,c,l,u,h,f,p=t&&t.split("/"),d=v.map,E=d&&d["*"]||{};if(e&&"."===e.charAt(0))if(t){for(p=p.slice(0,p.length-1),e=e.split("/"),o=e.length-1,v.nodeIdCompat&&H.test(e[o])&&(e[o]=e[o].replace(H,"")),e=p.concat(e),u=0;u<e.length;u+=1)if(f=e[u],"."===f)e.splice(u,1),u-=1;else if(".."===f){if(1===u&&(".."===e[2]||".."===e[0]))break;u>0&&(e.splice(u-1,2),u-=2)}e=e.join("/")}else 0===e.indexOf("./")&&(e=e.substring(2));if((p||E)&&d){for(n=e.split("/"),u=n.length;u>0;u-=1){if(r=n.slice(0,u).join("/"),p)for(h=p.length;h>0;h-=1)if(i=d[p.slice(0,h).join("/")],i&&(i=i[r])){s=i,a=u;break}if(s)break;!c&&E&&E[r]&&(c=E[r],l=u)}!s&&c&&(s=c,a=l),s&&(n.splice(0,a,s),e=n.join("/"))}return e}function o(e,t){return function(){return p.apply(r,T.call(arguments,0).concat([e,t]))}}function a(e){return function(t){return s(t,e)}}function c(e){return function(t){g[e]=t}}function l(e){if(i(m,e)){var t=m[e];delete m[e],w[e]=!0,f.apply(r,t)}if(!i(g,e)&&!i(w,e))throw new Error("No "+e);return g[e]}function u(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function h(e){return function(){return v&&v.config&&v.config[e]||{}}}var f,p,d,E,g={},m={},v={},w={},R=Object.prototype.hasOwnProperty,T=[].slice,H=/\.js$/;d=function(e,t){var n,r=u(e),i=r[0];return e=r[1],i&&(i=s(i,t),n=l(i)),i?e=n&&n.normalize?n.normalize(e,a(t)):s(e,t):(e=s(e,t),r=u(e),i=r[0],e=r[1],i&&(n=l(i))),{f:i?i+"!"+e:e,n:e,pr:i,p:n}},E={require:function(e){return o(e)},exports:function(e){var t=g[e];return"undefined"!=typeof t?t:g[e]={}},module:function(e){return{id:e,uri:"",exports:g[e],config:h(e)}}},f=function(e,t,n,s){var a,u,h,f,p,v,R=[],T=typeof n;if(s=s||e,"undefined"===T||"function"===T){for(t=!t.length&&n.length?["require","exports","module"]:t,p=0;p<t.length;p+=1)if(f=d(t[p],s),u=f.f,"require"===u)R[p]=E.require(e);else if("exports"===u)R[p]=E.exports(e),v=!0;else if("module"===u)a=R[p]=E.module(e);else if(i(g,u)||i(m,u)||i(w,u))R[p]=l(u);else{if(!f.p)throw new Error(e+" missing "+u);f.p.load(f.n,o(s,!0),c(u),{}),R[p]=g[u]}h=n?n.apply(g[e],R):void 0,e&&(a&&a.exports!==r&&a.exports!==g[e]?g[e]=a.exports:h===r&&v||(g[e]=h))}else e&&(g[e]=n)},e=t=p=function(e,t,n,i,s){if("string"==typeof e)return E[e]?E[e](t):l(d(e,t).f);if(!e.splice){if(v=e,v.deps&&p(v.deps,v.callback),!t)return;t.splice?(e=t,t=n,n=null):e=r}return t=t||function(){},"function"==typeof n&&(n=i,i=s),i?f(r,e,t,n):setTimeout(function(){f(r,e,t,n)},4),p},p.config=function(e){return p(e)},e._defined=g,n=function(e,t,n){t.splice||(n=t,t=[]),i(g,e)||i(m,e)||(m[e]=[e,t,n])},n.amd={jQuery:!0}}(),n("vendor/almond/almond",function(){}),n("charts/base",[],function(){return Base=function(){this.options={width:500,height:500,bg_color:16777215,legend:!0},this.width=function(e){return arguments.length?void(this.options.width=e):this.options.width},this.height=function(e){return arguments.length?void(this.options.height=e):this.options.height},this.bg_color=function(e){return arguments.length?void(this.options.bg_color=e):this.options.bg_color},this.legend=function(e){return arguments.length?void(this.options.legend=e):this.options.legend}}}),n("components/world",[],function(){function e(e,t){this.scene=new THREE.Scene,this.camera=new THREE.OrthographicCamera(-20,20,-20,20),this.scene.add(this.camera),this.camera.position.set(135,135,50),this.camera.lookAt(this.scene.position);for(var n=[[1,1,1],[-1,-1,1],[-1,1,1],[1,-1,1]],r=0;4>r;r++){var i=new THREE.DirectionalLight(14540253);i.position.set(n[r][0],n[r][1],1*n[r][2]),this.scene.add(i)}return this.controls=new THREE.TrackballControls(this.camera),this.renderer=new THREE.WebGLRenderer({antialias:!0}),this.renderer.setSize(t.width,t.height),this.renderer.setClearColor(t.bg_color,1),e.appendChild(this.renderer.domElement),this}var t;return e.prototype.begin=function(){t=this,this.animate()},e.prototype.animate=function(){requestAnimationFrame(t.animate),t.renderer.render(t.scene,t.camera),t.controls.update()},e.prototype.addMesh=function(e){if(e instanceof Array)for(var t=0;t<e.length;t++)this.scene.add(e[t]);else this.scene.add(e)},e}),n("components/space",[],function(){function e(e){var r=-10,i=10,s=i-r,o=new THREE.PlaneGeometry(s,s),a=new THREE.MeshBasicMaterial({color:15790320,shading:THREE.FlatShading,overdraw:.5,side:THREE.DoubleSide}),c=new THREE.Mesh(o,a),l=new THREE.Mesh(o,a),u=new THREE.Mesh(o,a);l.rotateOnAxis(new THREE.Vector3(1,0,0),Math.PI/2),l.translateOnAxis(new THREE.Vector3(0,1,0),10),l.translateOnAxis(new THREE.Vector3(0,0,1),10),u.rotateOnAxis(new THREE.Vector3(0,1,0),Math.PI/2),u.translateOnAxis(new THREE.Vector3(-1,0,0),10),u.translateOnAxis(new THREE.Vector3(0,0,1),10),this.scales={},this.scales.x=d3.scale.linear().domain([e[0][0],e[0][1]]).range([10,-10]),this.scales.y=d3.scale.linear().domain([e[1][0],e[1][1]]).range([10,-10]),this.scales.z=d3.scale.linear().domain([e[2][0],e[2][1]]).range([15,0]);var h=d3.select("body").append("svg").style("width","500").style("height","500").style("display","none");return h.append("g").attr("class","axis").call(d3.svg.axis().scale(this.scales.x).orient("left").ticks(5)),this.meshes=[],this.meshes.push(c),this.meshes.push(l),this.meshes.push(u),this.meshes.push(t()),this.meshes.push(n([-10,10],[-10,10],[0,0],2)),this.meshes.push(n([-10,10],[-10,-10],[0,20],2)),this.meshes.push(n([10,10],[-10,10],[0,20],2)),this}var t=function(){var e=new THREE.Geometry;e.vertices.push(new THREE.Vector3(-10,-10,0)),e.vertices.push(new THREE.Vector3(-10,10,0)),e.vertices.push(new THREE.Vector3(-10,10,0)),e.vertices.push(new THREE.Vector3(10,10,0)),e.vertices.push(new THREE.Vector3(10,10,0)),e.vertices.push(new THREE.Vector3(10,10,20));var t=new THREE.LineBasicMaterial({color:0,opacity:.2}),n=new THREE.Line(e,t);return n.type=THREE.LinePieces,n},n=function(e,t,n,r){var i=new THREE.Geometry;if(e[0]!=e[1])for(var s=e[0];s<=e[1];s+=r)i.vertices.push(new THREE.Vector3(s,t[0],n[0])),i.vertices.push(new THREE.Vector3(s,t[1],n[1]));if(t[0]!=t[1])for(var o=t[0];o<=t[1];o+=r)i.vertices.push(new THREE.Vector3(e[0],o,n[0])),i.vertices.push(new THREE.Vector3(e[1],o,n[1]));if(n[0]!=n[1])for(var a=n[0];a<=n[1];a+=r)i.vertices.push(new THREE.Vector3(e[0],t[0],a)),i.vertices.push(new THREE.Vector3(e[1],t[1],a));var c=new THREE.LineBasicMaterial({color:13421772,opacity:.2}),l=new THREE.Line(i,c);return l.type=THREE.LinePieces,l};return e.prototype.getScales=function(){return this.scales},e.prototype.getMesh=function(){return this.meshes},e}),n("components/legend",[],function(){function e(){return this}return e.prototype.addContinuousColormap=function(e,t){for(var n=d3.select("svg"),r=d3.scale.linear().domain([e[0],e[1]]).range([0,200]),i=n.append("svg:defs").append("svg:linearGradient").attr("id","gradient").attr("x1","0%").attr("x2","0%").attr("y1","100%").attr("y2","0%"),s=0;s<t.length;s++)i.append("svg:stop").attr("offset",100/t.length*s+"%").attr("stop-color",t[s]);var o=n.append("g");o.append("svg:rect").attr("y",10).attr("width","25").attr("height","200").style("fill","url(#gradient)"),n.append("g").attr("width","100").attr("height","200").attr("class","axis").attr("transform","translate(25,10)").call(d3.svg.axis().scale(r).orient("right").ticks(5))},e}),n("utils/utils",[],function(){var e=function(e,t){t.call(e)},t=function(e,t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])};return exports={mixin:e,merge:t}}),n("charts/surface",["charts/base","components/world","components/space","components/legend","utils/utils"],function(e,t,n,r,i){function s(s){i.mixin(this,e),i.merge(this.options,{fill_colors:colorbrewer.Reds[3]});var a,c,l={width:this.options.width,height:this.options.height,bg_color:this.options.bg_color};s.each(function(e){a=new t(this,l),c=e}),ranges=[];for(var u=[function(e){return e.x},function(e){return e.y},function(e){return e.z}],h=0;3>h;h++)ranges[h]=[d3.max(c,function(e){return d3.max(e,u[h])}),d3.min(c,function(e){return d3.min(e,u[h])})];var f=new n(ranges);a.addMesh(f.getMesh());var p=(ranges[2][0]+ranges[2][1])/2,d=d3.scale.linear().domain([ranges[2][1],p,ranges[2][0]]).range(this.options.fill_colors),E=o(c,f.getScales(),d);if(a.addMesh(E),1==this.options.legend){var g=new r;g.addContinuousColormap(ranges[2],this.options.fill_colors)}a.begin()}function o(e,t,n){var r=new THREE.Geometry,i=e.length,s=e[0].length,o=[],a=function(e,t){return e*i+t},c=function(e,t,n,r,i){var s=new THREE.Vector3,o=new THREE.Vector3;s.subVectors(e.vertices[t],e.vertices[n]),o.subVectors(e.vertices[t],e.vertices[r]),o.cross(s).normalize();var a=[i[t],i[n],i[r]];e.faces.push(new THREE.Face3(t,n,r,o,a)),a=[i[r],i[n],i[t]],e.faces.push(new THREE.Face3(r,n,t,o.negate(),a))};e.forEach(function(e){e.forEach(function(e){r.vertices.push(new THREE.Vector3(t.x(e.x),t.y(e.y),t.z(e.z))),o.push(new THREE.Color(n(e.z)))})});for(var l=0;i-1>l;l++)for(var u=0;s-1>u;u++)c(r,a(l,u),a(l+1,u),a(l,u+1),o),c(r,a(l+1,u),a(l+1,u+1),a(l,u+1),o);var h=new THREE.MeshBasicMaterial({vertexColors:THREE.VertexColors}),f=new THREE.Mesh(r,h);return f}return s.fill_colors=function(e){return arguments.length?void(this.options.fill_colors=e):this.options.bg_color},s}),n("main",["require","exports","module","charts/surface"],function(e){return Elegans={},Elegans.Surface=e("charts/surface"),Elegans}),t("main")});